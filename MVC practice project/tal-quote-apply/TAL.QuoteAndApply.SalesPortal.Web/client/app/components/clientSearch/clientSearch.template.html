<div class="tal-client-search" cg-busy="ctrl.loadingPromise">

    <h2>Search Existing Customers</h2>

    <form class="search-form clearfix" name="quoteReferenceForm">
        <h3><label for="quoteReferenceNumber" class="control-label">Quote Reference</label></h3>
        <div class="row">
            <div class="col-md-6">
                <div class="form-group" show-errors>
                    <input type="text"
                           name="quoteReferenceNumber"
                           id="quoteReferenceNumber"
                           class="form-control"
                           ng-model="ctrl.searchCriteria.quoteReferenceNumber"
                           tal-server-validate="searchClientsRequest.quoteReferenceNumber"
                           maxlength="10"
                           empty-to-null />
                    <tal-form-error ng-form-model="quoteReferenceForm.quoteReferenceNumber"></tal-form-error>
                </div>
            </div>
            <div class="col-md-3">
                <div class="button-area pull-left">
                    <input id="btnSearchQuoteReference" type="submit" class="btn btn-primary" value="Search" ng-click="ctrl.onSearchQuoteRefClick()" />
                </div>
            </div>
        </div>
    </form>

    <hr>

    <form class="search-form clearfix" name="leadIdForm">
        <h3>
            <label for="leadId" class="control-label">Adobe Id</label>
        </h3>
        <div class="row">
            <div class="col-md-6">
                <div class="form-group" show-errors>
                    <input type="tel"
                           name="leadId"
                           id="leadId"
                           class="form-control"
                           ng-model="ctrl.searchCriteria.leadId"
                           tal-server-validate="searchClientsRequest.leadId"
                           maxlength="10"
                           empty-to-null />
                    <tal-form-error ng-form-model="leadIdForm.leadId"></tal-form-error>
                </div>
            </div>
            <div class="col-md-3">
                <div class="button-area pull-left">
                    <input id="btnSearchLeadId" type="submit" class="btn btn-primary" value="Search" ng-click="ctrl.onSearchLeadClick()" />
                </div>
            </div>
        </div>
    </form>

    <hr>

    <form class="search-form search-party clearfix" name="partyDetailsForm">
        <h3>Customer Details</h3>
        <div class="row">
            <div class="col-md-3">
                <label for="firstName" class="control-label">Name</label>
                <div class="form-group" show-errors>
                    <input type="text"
                           name="firstName"
                           id="firstName"
                           class="form-control"
                           ng-model="ctrl.searchCriteria.firstName"
                           tal-server-validate="searchClientsRequest.firstName"
                           maxlength="200"/>
                    <tal-form-error ng-form-model="partyDetailsForm.firstName"></tal-form-error>
                </div>
            </div>
            <div class="col-md-3">
                <div class="form-group" show-errors>
                    <label for="surname" class="control-label">Surname</label>
                    <input type="text"
                           name="surname"
                           id="surname"
                           class="form-control"
                           ng-model="ctrl.searchCriteria.surname"
                           tal-server-validate="searchClientsRequest.surname"
                           maxlength="200"/>
                    <tal-form-error ng-form-model="partyDetailsForm.surname"></tal-form-error>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-6">
                <div class="form-group">
                    <tal-dob-with-age id="dateOfBirth" warnings-enabled="false" section="section" ng-model="ctrl.searchCriteria.dateOfBirth"
                                      no-inline-submit="true"
                                      server-validate="searchClientsRequest.dateOfBirth"></tal-dob-with-age>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-3">
                <div class="form-group" show-errors>
                    <label for="mobileNumber" class="control-label">Mobile Number</label>
                    <input type="text"
                           name="mobileNumber"
                           id="mobileNumber"
                           class="form-control"
                           ng-model="ctrl.searchCriteria.mobileNumber"
                           tal-server-validate="searchClientsRequest.mobileNumber"
                           maxlength="10"/>
                    <tal-form-error ng-form-model="partyDetailsForm.mobileNumber"></tal-form-error>
                </div>
            </div>
            <div class="col-md-3">
                <div class="form-group" show-errors>
                    <label for="homeNumber" class="control-label">Home Number</label>
                    <input type="text"
                           name="homeNumber"
                           id="homeNumber"
                           class="form-control"
                           ng-model="ctrl.searchCriteria.homeNumber"
                           tal-server-validate="searchClientsRequest.homeNumber"
                           maxlength="10" />
                    <tal-form-error ng-form-model="partyDetailsForm.homeNumber"></tal-form-error>
                </div>
            </div>
            <div class="col-md-3">
                <div class="button-area pull-left">
                    <input id="btnSearchPartyIifo" type="submit" class="btn btn-primary" value="Search" ng-click="ctrl.onSearchPartyClick()"/>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-3">
                <div class="form-group" show-errors>
                    <label for="emailAddress" class="control-label">Email Address</label>
                    <input type="text"
                           name="emailAddress"
                           id="emailAddress"
                           class="form-control"
                           ng-model="ctrl.searchCriteria.emailAddress"
                           tal-server-validate="searchClientsRequest.emailAddress"
                           maxlength="200" />
                    <tal-form-error ng-form-model="partyDetailsForm.emailAddress"></tal-form-error>
                </div>
            </div>
            <div class="col-md-3">
                <div class="form-group"  ng-show="ctrl.externalRefRequired" show-errors>
                    <label for="externalCustomerReference" class="control-label"> {{ ctrl.externalRefLabel || "External Customer Reference"}} </label>
                    <input type="text"
                           name="externalCustomerReference"
                           id="externalCustomerReference"
                           class="form-control"
                           ng-model="ctrl.searchCriteria.externalCustomerReference"
                           tal-server-validate="searchClientsRequest.externalCustomerReference"
                           maxlength="20" />
                    <tal-form-error ng-form-model="partyDetailsForm.externalCustomerReference"></tal-form-error>
                </div>
            </div>
        </div>
</form>
    <div ng-show="ctrl.searchPerformed && ctrl.isQuotesResult()">
        <h2>Search Quote Results</h2>
        <div class="search-results">
            <table class="table table-striped search-results-table" ng-show="ctrl.hasQuoteResults()">
                <tr>
                    <th>Owner</th>
                    <th>Date Of Birth</th>
                    <th>Brand</th>
                    <th ng-show="ctrl.externalRefRequired" >{{ ctrl.externalRefLabel || "External Customer Reference"}}</th>
                    <th>State</th>
                    <th>Phone</th>
                    <th>Email</th>
                    <th>Quote Reference</th>
                    <th>Premium</th>
                    <th>Adobe Id</th>
                    <th>Action</th>
                </tr>
                <tr ng-repeat="quote in ctrl.searchResults.quotes">
                    <td ng-bind="quote.ownerName"></td>
                    <td ng-bind="quote.ownerDateOfBirth"></td>
                    <td ng-bind="quote.brand"></td>
                    <td ng-show="ctrl.externalRefRequired" ng-bind="quote.externalCustomerReference"></td>
                    <td ng-bind="quote.ownerState"></td>
                    <td ng-bind="quote.ownerPhoneNumber"></td>
                    <td ng-bind="quote.ownerEmailAddress"></td>
                    <td ng-bind="quote.quoteReferenceNumber"></td>
                    <td ng-bind="quote.premium | currency"></td>
                    <td ng-bind="quote.leadId"></td>
                    <td>
                        <button id="btnOpenRecord{{quote.quoteReferenceNumber}}" class="btn btn-open-action" ng-click="ctrl.openQuote(quote.quoteReferenceNumber)">Open</button>
                    </td>
                </tr>
            </table>
            <div class="no-results" ng-show="!ctrl.hasQuoteResults()">
                0 Results found
            </div>
        </div>
        <div class="clearfix button-area">
            <button id="btnCreateNewClient" ng-if="ctrl.validForCreateNewClient" class="pull-right btn btn-primary" ng-click="ctrl.onCreateClient()">Create New Customer</button>
        </div>
    </div>

    <div ng-show="ctrl.searchPerformed && ctrl.isLeadsResult()">
        <h2>Search Lead Results</h2>
        <div class="search-results">
            <table class="table table-striped search-results-table" ng-show="ctrl.hasLeadResults()">
                <tr>
                    <th>Owner</th>
                    <th>Date Of Birth</th>
                    <th>Brand</th>
                    <th ng-show="ctrl.externalRefRequired" >{{ ctrl.externalRefLabel || "External Customer Reference"}}</th>
                    <th>State</th>
                    <th>Phone Number</th>
                    <th>Email Address</th>
                    <th>Adobe Id</th>
                </tr>
                <tr ng-repeat="lead in ctrl.searchResults.quotes">
                    <td ng-bind="lead.ownerName"></td>
                    <td ng-bind="lead.ownerDateOfBirth"></td>
                    <td ng-bind="lead.brand"></td>
                    <td ng-show="ctrl.externalRefRequired" ng-bind="lead.externalCustomerReference"></td>
                    <td ng-bind="lead.ownerState"></td>
                    <td ng-bind="lead.ownerPhoneNumber"></td>
                    <td ng-bind="lead.ownerEmailAddress"></td>
                    <td ng-bind="lead.leadId"></td>
                </tr>
            </table>
            <div class="no-results" ng-show="!ctrl.hasLeadResults()">
                0 Results found
            </div>
        </div>
        <div class="clearfix button-area">
            <button class="pull-right btn btn-primary" ng-if="ctrl.validForCreateNewClient" ng-click="ctrl.onCreateClient()">Create New Customer</button>
        </div>
    </div>
</div>